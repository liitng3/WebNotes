var np={};function comList(){var n,s=$('<div class="notepad-com-list"><input class="editor" type="text"><br><ul class="list"></ul></div>'),i=s.find(".editor"),o=s.find(".list");function t(t){var e=$(t.container).find(".notepad-com-list");0!==e.length&&e.remove(),$(t.container).append(s),s.css({width:t.width}),function(t){var e,l=0;if(1==t.isFont)for(l=0;l<t.list.length;l++)(e=$('<li class="item"></li>')).css({"font-family":t.list[l]}),e.html(t.list[l]),o.append(e);else if(1==t.isFontStyle)for(l=0;l<t.list.length;l++)e=$('<li class="item"></li>'),"斜体"===t.list[l]?e.css({"font-style":"italic"}):"粗体"===t.list[l]?e.css({"font-weight":"bold"}):"粗偏斜体"===t.list[l]&&e.css({"font-weight":"bold","font-style":"italic"}),e.html(t.list[l]),o.append(e);else for(l=0;l<t.list.length;l++)(e=$('<li class="item"></li>')).html(t.list[l]),o.append(e);n=o.find(".item")}(t),$(n[t.select]).addClass("selected");var l=t.select;i.val(t.list[l]),i.select()}this.show=function(e){t(e),o.click(function(t){$(n[e.select]).removeClass("selected"),e.select=e.list.indexOf($(t.target).html()),$(n[e.select]).addClass("selected"),i.val(e.list[e.select]),i.select(),e.selectHandler(e.select)})}}np.wrap=!0,np.fontFamily="Arial",np.fontStyle="常规",np.fontSize="16",np.fontHandler=function(t){np.fontFamily=t.family,np.fontStyle=t.style,np.fontSize=t.size},$(function(){var t=$("body"),e=new Menubar(np.menuData),l=new Editor(np);t.click(function(){l.setFont(np),e.hideMenu(),l.focus()})}),np.menuData=[{title:"文件(F)",menuItems:[{title:"新建(N)",shortcut:"Ctrl+N",enabled:!0,handler:function(){console.log("未实现!")}},{title:"打开(O)...",shortcut:"Ctrl+O",enabled:!0,handler:function(){console.log("未实现!")}},{title:"保存(S)",shortcut:"Ctrl+S",enabled:!0,handler:function(){console.log("未实现!")}},{title:"另存为(A)...",shortcut:"",enabled:!0,handler:function(){console.log("未实现!")}},{title:"hr",shortcut:"",enabled:!0,handler:function(){console.log("未实现!")}},{title:"页面设置(U)...",shortcut:"",enabled:!0,handler:function(){console.log("未实现!")}},{title:"打印(P)...",shortcut:"Ctrl+P",enabled:!0,handler:function(){console.log("未实现!")}},{title:"hr",shortcut:"",enabled:!0,handler:function(){console.log("未实现!")}},{title:"退出(X)",shortcut:"",enabled:!0,handler:function(){console.log("未实现!")}}],width:"202px",left:"0px"},{title:"编辑(E)",menuItems:[{title:"撤销(U)",shortcut:"Ctrl+Z",enabled:!1,handler:function(){console.log("未实现!")}},{title:"hr",shortcut:"",enabled:!0,handler:function(){console.log("未实现!")}},{title:"剪切(T)",shortcut:"Ctrl+X",enabled:!0,handler:function(){console.log("未实现!")}},{title:"复制(C)",shortcut:"Ctrl+C",enabled:!1,handler:function(){console.log("未实现!")}},{title:"粘贴(P)",shortcut:"Ctrl+V",enabled:!1,handler:function(){console.log("未实现!")}},{title:"删除(L)",shortcut:"Del",enabled:!1,handler:function(){console.log("未实现!")}},{title:"hr",shortcut:"",enabled:!0,handler:function(){console.log("未实现!")}},{title:"使用 Bing 搜索...",shortcut:"Ctrl+E",enabled:!0,handler:function(){console.log("未实现!")}},{title:"查找(F)...",shortcut:"Ctrl+F",enabled:!1,handler:function(){console.log("未实现!")}},{title:"查找下一个(N)",shortcut:"F3",enabled:!1,handler:function(){console.log("未实现!")}},{title:"替换(R)...",shortcut:"Ctrl+H",enabled:!0,handler:function(){console.log("未实现!")}},{title:"转到(G)...",shortcut:"Ctrl+G",enabled:!0,handler:function(){console.log("未实现!")}},{title:"hr",shortcut:"",enabled:!0,handler:function(){console.log("未实现!")}},{title:"全选(A)",shortcut:"Ctrl+A",enabled:!0,handler:function(){console.log("未实现!")}},{title:"时间/日期(D)",shortcut:"F5",enabled:!0,handler:function(){console.log("未实现!")}}],width:"218px",left:"52px"},{title:"格式(O)",menuItems:[{title:"自动换行(W)",shortcut:"",enabled:!0,handler:function(){console.log("未实现!")}},{title:"字体(F)...",shortcut:"",enabled:!0,handler:function(){new dlgFont(np).show()}}],width:"156px",left:"106px"},{title:"查看(V)",menuItems:[{title:"状态栏(S)",shortcut:"",enabled:!0,handler:function(){console.log("未实现!")}}],width:"138px",left:"162px"},{title:"帮助(H)",menuItems:[{title:"查看帮助(H)",shortcut:"",enabled:!0,handler:function(){console.log("未实现!")}},{title:"关于记事本(A)",shortcut:"",enabled:!0,handler:function(){console.log("未实现!")}}],width:"166px",left:"216px"}],function(){function t(t){this.$dlg=$('<div class="notepad-dlg-mask notepad-dlg-font"><div class="dialogbox notepad-dlgbox"><div class="notepad-dlg-titlebar"><p class="title">字体</p><span class="close-btn" title="关闭">✖</span></div><div class="main notepad-dlg-main"><div class="font-family"><p>字体(F):</p></div><div class="font-style"><p>字形(Y):</p></div><div class="font-size"><p>大小(S):</p></div><fieldset class="sample"><legend>示例</legend><p class="sample-txt">AaBbYyZz</p></fieldset><div class="script"><label>脚本(R):<br><select><option value="西欧语言">西欧语言</option><option value="中文 GB2312">中文 GB2312</option></select></label></div><input class="btn-ok btn" type="button" value="确定"><input class="btn-cancel btn" type="button" value="取消"></div></div></div>'),this.$btnOk=this.$dlg.find(".btn-ok"),this.$btnClose=this.$dlg.find(".close-btn"),this.$btnCancel=this.$dlg.find(".btn-cancel"),this.$sample=this.$dlg.find(".sample-txt"),this.$titleBar=this.$dlg.find(".notepad-dlg-titlebar"),this.fonts=["Agency FB","Algerian","Arial","Arial Rounded MT","Axure Handwriting","Bahnschrift","Baskerville Old Face","Bauhaus 93","Bell MT","Berlin Sans FB","Bernard MT","BlackAdder ITC"],this.styles=["常规","斜体","粗体","粗偏斜体"],this.sizes=["8","9","10","11","12","14","16","18","20","22","24","26","28","36","48","72"],this.contain=[".notepad-dlg-font .font-family",".notepad-dlg-font .font-style",".notepad-dlg-font .font-size"],this.family=t.fontFamily,this.style=t.fontStyle,this.size=t.fontSize}(window.dlgFont=t).prototype.sample=function(){this.$sample.css({"font-family":this.family,"font-size":this.size+"pt"}),"斜体"!=this.style?"粗体"!=this.style?"粗偏斜体"!=this.style?this.$sample.css({"font-style":"normal","font-weight":"normal"}):this.$sample.css({"font-style":"italic","font-weight":"bold"}):this.$sample.css({"font-style":"normal","font-weight":"bold"}):this.$sample.css({"font-style":"italic","font-weight":"normal"})},t.prototype.show=function(){$("body").append(this.$dlg);var e=this;(new comList).show({container:this.contain[0],width:"176px",list:this.fonts,select:this.fonts.indexOf(this.family),isFont:!0,isFontStyle:!1,selectHandler:function(t){e.family=e.fonts[t],e.sample()}}),(new comList).show({container:this.contain[1],width:"132px",list:this.styles,select:this.styles.indexOf(this.style),isFont:!1,isFontStyle:!0,selectHandler:function(t){e.style=e.styles[t],e.sample()}}),(new comList).show({container:this.contain[2],width:"64px",list:this.sizes,select:this.sizes.indexOf(this.size),isFont:!1,isFontStyle:!1,selectHandler:function(t){e.size=e.sizes[t],e.sample()}}),this.sample(),this.$dlg.find(".dialogbox").draggable({handle:this.$titleBar}),this.$btnClose.click(function(){e.$dlg.remove()}),this.$btnCancel.click(function(){e.$dlg.remove()}),this.$btnOk.click(function(){np.fontHandler({family:e.family,style:e.style,size:e.size}),e.$dlg.remove()}),this.$dlg.click(function(t){t.stopPropagation()})}}(),function(){function t(t){this.$editordom=$('<div class="notepad-editor"><textarea spellcheck="false" auto-size="none"></textarea></div>'),this.$textArea=this.$editordom.find("textarea"),this.wrap=t.wrap,this.fontFamily=t.fontFamily,this.fontStyle=t.fontStyle,this.fontSize=t.fontSize,this.show(),this.setFont(t)}(window.Editor=t).prototype.focus=function(){this.$textArea.focus()},t.prototype.setWrap=function(){this.wrap?(this.$textArea.attr("wrap","soft"),this.$textArea.css({"overflow-x":"hidden"})):(this.$textArea.attr("wrap","off"),this.$textArea.css({"overflow-x":"scroll"}))},t.prototype.setFont=function(t){if(this.$textArea.css({"font-family":t.fontFamily,"font-size":t.fontSize+"pt"}),"斜体"!==t.fontStyle){if("粗体"!==t.fontStyle)return"粗偏斜体"===t.fontStyle?void this.$textArea.css({"font-style":"italic","font-weight":"bold"}):void this.$textArea.css({"font-style":"normal","font-weight":"normal"});this.$textArea.css({"font-style":"normal","font-weight":"bold"})}else this.$textArea.css({"font-style":"italic","font-weight":"normal"})},t.prototype.show=function(){$("body").append(this.$editordom),this.$textArea.trigger("focus"),this.setWrap()}}(),function(){function t(t){this.$menudom=$('<div class="notepad-menubar"></div>'),this.menus=[],this.pull=-1,this.menuData=t,this.$titlesList=null,this.show()}(window.Menubar=t).prototype.createMenuTitle=function(){for(var e=this,t=$('<ul class="menu-title"></ul>'),l=0;l<this.menuData.length;l++){var n=$('<li class="title"></li>');n.html(this.menuData[l].title),t.append(n)}this.createMenus(),this.$titlesList=t.find("li"),this.$titlesList.click(function(t){e.clickevent(t,$(this).index())}),this.$titlesList.hover(function(t){e.hoverevent($(this).index())}),this.$menudom.append(t)},t.prototype.clickevent=function(t,e){var l=e;-1===this.pull?(this.menus[l].css({display:"inline-block"}),this.pull=l):this.pull!==l?(this.menus[this.pull].css({display:"none"}),this.menus[l].css({display:"inline-block"}),this.pull=l):(this.menus[this.pull].css({display:"none"}),this.pull=-1),t.stopPropagation()},t.prototype.hoverevent=function(t){if(-1!==this.pull){var e=t;this.menus[this.pull].css({display:"none"}),this.menus[e].css({display:"inline-block"}),this.pull=e}},t.prototype.createMenus=function(){for(var t=0;t<this.menuData.length;t++){for(var e=$('<ul class="menus"></ul>'),l=this.menuData[t].menuItems,n=0;n<l.length;n++)if("hr"===l[n].title){var s=$('<li class="menu-hr"></li>');e.append(s)}else{var i=$('<li class="menu-item"></li>');if(i.html(l[n].title),i.attr("data-x",t),i.attr("data-y",n),""!==l[n].shortcut){var o=$('<span class="shortcut"></span>');o.html(l[n].shortcut),i.append(o)}l[n].enabled||i.addClass("disabled"),e.append(i);var a=this;i.click(function(t){if(t.stopPropagation(),!$(this).hasClass("disabled")){console.log(this.dataset.x),console.log(this.dataset.y);var e=this.dataset.x,l=this.dataset.y;a.menus[e].css({display:"none"}),a.pull=-1,a.menuData[e].menuItems[l].handler()}})}e.css({width:this.menuData[t].width,left:this.menuData[t].left,display:"none"}),this.$menudom.append(e),this.menus.push(e)}},t.prototype.hideMenu=function(){-1!==this.pull&&(this.menus[this.pull].css({display:"none"}),this.pull=-1)},t.prototype.enabled=function(t,e,l){var n=this.menus[t].find(".menu-item")[e];l?$(n).removeClass("disabled"):$(n).addClass("disabled")},t.prototype.show=function(){this.createMenuTitle(),$("body").append(this.$menudom)}}();